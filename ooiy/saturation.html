<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Adjust Saturation</title>
    <style>
        *{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI',Tahoma,Arial,sans-serif}
        body{background:linear-gradient(135deg,#1a1a1a,#2d2d2d);min-height:100vh;color:#fff;display:flex;flex-direction:column}
        .top-bar{position:fixed;top:0;left:0;right:0;height:60px;background:rgba(0,0,0,.8);backdrop-filter:blur(10px);display:flex;align-items:center;justify-content:space-between;padding:0 1rem;z-index:100}
        .back-btn{background:none;border:none;color:#fff;font-size:1.4rem;cursor:pointer}
        .top-bar h1{font-size:1.1rem;background:linear-gradient(45deg,#6b9fff,#ff69b4);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
        .image-preview{margin-top:60px;height:50vh;display:flex;align-items:center;justify-content:center;padding:1rem;background:rgba(0,0,0,.18)}
        #preview-image{max-width:100%;max-height:100%;border-radius:10px;box-shadow:0 4px 15px rgba(0,0,0,.3)}
        .controls{padding:1.5rem;background:rgba(0,0,0,.85);position:fixed;left:0;right:0;bottom:0}
        .slider-container{margin-bottom:1rem}
        .slider-label{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}
        .slider-value{background:rgba(107,159,255,.16);padding:.4rem .8rem;border-radius:12px;min-width:56px;text-align:center}
        .range-slider{appearance:none;width:100%;height:20px;background:rgba(255,255,255,.08);border-radius:12px;outline:none}
        .range-slider::-webkit-slider-thumb{appearance:none;width:36px;height:36px;background:linear-gradient(45deg,#6b9fff,#ff69b4);border-radius:50%;border:3px solid #fff;cursor:pointer}
        .preset-row{display:flex;gap:.5rem;margin-bottom:.75rem;overflow-x:auto;padding-bottom:.25rem}
        .preset{min-width:80px;padding:.5rem .75rem;border-radius:10px;background:rgba(255,255,255,.03);text-align:center;cursor:pointer;border:1px solid rgba(255,255,255,.04)}
        .preset.active{box-shadow:0 6px 18px rgba(107,159,255,.18);border-color:rgba(107,159,255,.35)}
        .button-container{display:flex;gap:.75rem}
        .control-btn{flex:1;padding:1rem;border-radius:28px;border:none;font-size:1rem;cursor:pointer}
        .reset-btn{background:rgba(255,255,255,.08);color:#fff}
        .apply-btn{background:linear-gradient(45deg,#6b9fff,#ff69b4);color:#fff}
    </style>
</head>
<body>
    <div class="top-bar">
        <button class="back-btn" onclick="history.back()">‚Üê</button>
        <h1>Adjust Saturation</h1>
        <div style="width:24px"></div>
    </div>

    <div class="image-preview">
        <img id="preview-image" alt="Preview">
    </div>

    <div class="controls">
        <div class="preset-row" id="presets">
            <div class="preset" data-val="-50">Desaturate</div>
            <div class="preset" data-val="-20">Subtle</div>
            <div class="preset" data-val="0">Original</div>
            <div class="preset" data-val="20">Vivid</div>
            <div class="preset" data-val="40">Color Pop</div>
            <div class="preset" data-val="70">Ultra</div>
        </div>

        <div class="slider-container">
            <div class="slider-label">
                <span>Saturation</span>
                <span class="slider-value" id="saturation-value">0%</span>
            </div>
            <input id="saturation-slider" class="range-slider" type="range" min="-100" max="100" value="0">
        </div>

        <div class="button-container">
            <button class="control-btn reset-btn" id="resetBtn">Reset</button>
            <button class="control-btn apply-btn" id="applyBtn">Apply</button>
        </div>
    </div>

    <script>
        let originalImage = null;
        const slider = document.getElementById('saturation-slider');
        const valueLabel = document.getElementById('saturation-value');
        const previewImage = document.getElementById('preview-image');
        const presets = document.getElementById('presets');
        const resetBtn = document.getElementById('resetBtn');
        const applyBtn = document.getElementById('applyBtn');

        window.onload = function(){
            const data = localStorage.getItem('editImage');
            if(data){
                originalImage = data;
                previewImage.src = data;
                updatePreview(0);
            }
        };

        // slider live preview
        slider.oninput = function(){
            const v = parseInt(this.value,10);
            valueLabel.textContent = (v>0?'+':'') + v + '%';
            updatePreview(v);
            highlightPreset(v);
        };

        function updatePreview(v){
            const pct = 100 + v; // e.g. v=0 => 100%
            previewImage.style.filter = `saturate(${pct}%)`;
        }

        // presets click
        presets.addEventListener('click', (e)=>{
            const p = e.target.closest('.preset');
            if(!p) return;
            const val = parseInt(p.dataset.val,10);
            slider.value = val;
            valueLabel.textContent = (val>0?'+':'') + val + '%';
            updatePreview(val);
            highlightPreset(val);
        });

        function highlightPreset(v){
            document.querySelectorAll('.preset').forEach(p=>{
                p.classList.toggle('active', parseInt(p.dataset.val,10)===parseInt(v,10));
            });
        }

        resetBtn.onclick = function(){
            slider.value = 0;
            valueLabel.textContent = '0%';
            previewImage.style.filter = 'saturate(100%)';
            highlightPreset(0);
        };

        applyBtn.onclick = function(){
            const sat = 100 + parseInt(slider.value,10);
            // draw to canvas with filter applied
            const img = new Image();
            img.onload = function(){
                const canvas = document.createElement('canvas');
                canvas.width = img.width;
                canvas.height = img.height;
                const ctx = canvas.getContext('2d');
                ctx.filter = `saturate(${sat}%)`;
                ctx.drawImage(img,0,0);
                const newData = canvas.toDataURL('image/jpeg');
                localStorage.setItem('editImage', newData);
                history.back();
            };
            img.src = originalImage;
        };
    </script>
</body>
</html>